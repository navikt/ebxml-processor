import kotlinx.serialization.encodeToString
import kotlinx.serialization.json.Json
import no.nav.emottak.fellesformat.marshal
import no.nav.emottak.fellesformat.wrapMessageInEIFellesFormat
import no.nav.emottak.melding.model.Addressing
import no.nav.emottak.melding.model.EbmsProcessing
import no.nav.emottak.melding.model.Party
import no.nav.emottak.melding.model.PartyId
import no.nav.emottak.melding.model.SendInRequest
import org.junit.jupiter.api.Disabled
import org.junit.jupiter.api.Test

class PasientListeTestTemp {

    @Test
    @Disabled
    fun `Build request`() {
        val processedPayload = this::class.java.classLoader
            .getResourceAsStream("hentpasientliste/hentpasientliste-payload.xml")!!.readAllBytes()

        val sendInRequest = SendInRequest(
            messageId = "90e65f73-1622-4c5a-84df-cac621e67858",
            conversationId = "a1d4e6c8-25f0-47f8-ad49-8bad23842ef3",
            payloadId = "cid:attachment-1-90e65f73-1622-4c5a-84df-cac621e67858",
            payload = processedPayload,
            addressing = Addressing(
                to = Party(
                    listOf(
                        PartyId(
                            type = "HER",
                            value = "79768" // NAV
                        )
                    ),
                    "Fastlegeregister"
                ),
                from = Party(
                    listOf(
                        PartyId(
                            type = "HER",
                            value = "8140996"
                        )
                    ),
                    "Fastlege"
                ),
                service = "PasientlisteForesporsel",
                action = "HentPasientliste"
            ),
            ebmsProcessing = EbmsProcessing(
                test = "123"
            )
        )

        val prettyJson = Json {
            prettyPrint = true
            prettyPrintIndent = " "
        }

        val string = prettyJson.encodeToString(sendInRequest)
        print(string)
    }

    @Test
    @Disabled
    fun marshalBase64Payload() {
        val processedPayload = this::class.java.classLoader
            .getResourceAsStream("hentpasientliste/hentpasientliste-payload.xml")!!.readAllBytes()

        val sendInRequest = SendInRequest(
            messageId = "90e65f73-1622-4c5a-84df-cac621e67858",
            conversationId = "a1d4e6c8-25f0-47f8-ad49-8bad23842ef3",
            payloadId = "cid:attachment-1-90e65f73-1622-4c5a-84df-cac621e67858",
            payload = processedPayload,
            addressing = Addressing(
                to = Party(
                    listOf(
                        PartyId(
                            type = "HER",
                            value = "79768" // NAV
                        )
                    ),
                    "Fastlegeregister"
                ),
                from = Party(
                    listOf(
                        PartyId(
                            type = "HER",
                            value = "8140996"
                        )
                    ),
                    "Fastlege"
                ),
                service = "PasientlisteForesporsel",
                action = "HentPasientliste"
            ),
            ebmsProcessing = EbmsProcessing(
                test = "123"
            )
        )

        val fellesFormat = wrapMessageInEIFellesFormat(sendInRequest)
        print("Here is marshalled fellesformat: " + marshal(fellesFormat))
    }

    @Test
    @Disabled
    fun readByteArrayToString() {
        val payloadAsByteArray = byteArrayOf(
            60,
            63,
            120,
            109,
            108,
            32,
            118,
            101,
            114,
            115,
            105,
            111,
            110,
            61,
            34,
            49,
            46,
            48,
            34,
            32,
            101,
            110,
            99,
            111,
            100,
            105,
            110,
            103,
            61,
            34,
            85,
            84,
            70,
            45,
            56,
            34,
            32,
            115,
            116,
            97,
            110,
            100,
            97,
            108,
            111,
            110,
            101,
            61,
            34,
            121,
            101,
            115,
            34,
            63,
            62,
            60,
            110,
            115,
            57,
            58,
            65,
            112,
            112,
            82,
            101,
            99,
            32,
            120,
            109,
            108,
            110,
            115,
            58,
            110,
            115,
            49,
            61,
            34,
            104,
            116,
            116,
            112,
            58,
            47,
            47,
            119,
            119,
            119,
            46,
            111,
            97,
            115,
            105,
            115,
            45,
            111,
            112,
            101,
            110,
            46,
            111,
            114,
            103,
            47,
            99,
            111,
            109,
            109,
            105,
            116,
            116,
            101,
            101,
            115,
            47,
            101,
            98,
            120,
            109,
            108,
            45,
            99,
            112,
            112,
            97,
            47,
            115,
            99,
            104,
            101,
            109,
            97,
            47,
            99,
            112,
            112,
            45,
            99,
            112,
            97,
            45,
            50,
            95,
            48,
            46,
            120,
            115,
            100,
            34,
            32,
            120,
            109,
            108,
            110,
            115,
            58,
            110,
            115,
            50,
            61,
            34,
            104,
            116,
            116,
            112,
            58,
            47,
            47,
            119,
            119,
            119,
            46,
            119,
            51,
            46,
            111,
            114,
            103,
            47,
            50,
            48,
            48,
            48,
            47,
            48,
            57,
            47,
            120,
            109,
            108,
            100,
            115,
            105,
            103,
            35,
            34,
            32,
            120,
            109,
            108,
            110,
            115,
            58,
            110,
            115,
            51,
            61,
            34,
            104,
            116,
            116,
            112,
            58,
            47,
            47,
            119,
            119,
            119,
            46,
            119,
            51,
            46,
            111,
            114,
            103,
            47,
            49,
            57,
            57,
            57,
            47,
            120,
            108,
            105,
            110,
            107,
            34,
            32,
            120,
            109,
            108,
            110,
            115,
            58,
            110,
            115,
            52,
            61,
            34,
            104,
            116,
            116,
            112,
            58,
            47,
            47,
            115,
            99,
            104,
            101,
            109,
            97,
            115,
            46,
            120,
            109,
            108,
            115,
            111,
            97,
            112,
            46,
            111,
            114,
            103,
            47,
            115,
            111,
            97,
            112,
            47,
            101,
            110,
            118,
            101,
            108,
            111,
            112,
            101,
            47,
            34,
            32,
            120,
            109,
            108,
            110,
            115,
            58,
            110,
            115,
            54,
            61,
            34,
            104,
            116,
            116,
            112,
            58,
            47,
            47,
            119,
            119,
            119,
            46,
            119,
            51,
            46,
            111,
            114,
            103,
            47,
            50,
            48,
            48,
            57,
            47,
            120,
            109,
            108,
            100,
            115,
            105,
            103,
            49,
            49,
            35,
            34,
            32,
            120,
            109,
            108,
            110,
            115,
            58,
            110,
            115,
            55,
            61,
            34,
            104,
            116,
            116,
            112,
            58,
            47,
            47,
            119,
            119,
            119,
            46,
            107,
            105,
            116,
            104,
            46,
            110,
            111,
            47,
            120,
            109,
            108,
            115,
            116,
            100,
            115,
            47,
            109,
            115,
            103,
            104,
            101,
            97,
            100,
            47,
            50,
            48,
            48,
            54,
            45,
            48,
            53,
            45,
            50,
            52,
            34,
            32,
            120,
            109,
            108,
            110,
            115,
            58,
            110,
            115,
            56,
            61,
            34,
            104,
            116,
            116,
            112,
            58,
            47,
            47,
            119,
            119,
            119,
            46,
            116,
            114,
            121,
            103,
            100,
            101,
            101,
            116,
            97,
            116,
            101,
            110,
            46,
            110,
            111,
            47,
            120,
            109,
            108,
            47,
            101,
            105,
            102,
            102,
            47,
            49,
            47,
            34,
            32,
            120,
            109,
            108,
            110,
            115,
            58,
            110,
            115,
            57,
            61,
            34,
            104,
            116,
            116,
            112,
            58,
            47,
            47,
            119,
            119,
            119,
            46,
            107,
            105,
            116,
            104,
            46,
            110,
            111,
            47,
            120,
            109,
            108,
            115,
            116,
            100,
            115,
            47,
            97,
            112,
            112,
            114,
            101,
            99,
            47,
            50,
            48,
            48,
            52,
            45,
            49,
            49,
            45,
            50,
            49,
            34,
            32,
            120,
            109,
            108,
            110,
            115,
            58,
            110,
            115,
            49,
            48,
            61,
            34,
            104,
            116,
            116,
            112,
            58,
            47,
            47,
            110,
            97,
            118,
            46,
            110,
            111,
            47,
            116,
            106,
            101,
            110,
            101,
            115,
            116,
            101,
            47,
            101,
            107,
            115,
            116,
            101,
            114,
            110,
            47,
            102,
            114,
            105,
            107,
            111,
            114,
            116,
            47,
            118,
            49,
            47,
            116,
            121,
            112,
            101,
            115,
            34,
            62,
            60,
            110,
            115,
            57,
            58,
            77,
            115,
            103,
            84,
            121,
            112,
            101,
            32,
            86,
            61,
            34,
            65,
            80,
            80,
            82,
            69,
            67,
            34,
            47,
            62,
            60,
            110,
            115,
            57,
            58,
            77,
            73,
            71,
            118,
            101,
            114,
            115,
            105,
            111,
            110,
            62,
            49,
            46,
            48,
            32,
            50,
            48,
            48,
            52,
            45,
            49,
            49,
            45,
            50,
            49,
            60,
            47,
            110,
            115,
            57,
            58,
            77,
            73,
            71,
            118,
            101,
            114,
            115,
            105,
            111,
            110,
            62,
            60,
            110,
            115,
            57,
            58,
            71,
            101,
            110,
            68,
            97,
            116,
            101,
            62,
            50,
            48,
            50,
            52,
            45,
            48,
            57,
            45,
            49,
            54,
            84,
            49,
            52,
            58,
            53,
            51,
            58,
            52,
            50,
            46,
            54,
            53,
            55,
            43,
            48,
            50,
            58,
            48,
            48,
            60,
            47,
            110,
            115,
            57,
            58,
            71,
            101,
            110,
            68,
            97,
            116,
            101,
            62,
            60,
            110,
            115,
            57,
            58,
            73,
            100,
            62,
            51,
            57,
            102,
            97,
            53,
            53,
            98,
            48,
            45,
            97,
            98,
            56,
            51,
            45,
            52,
            51,
            56,
            50,
            45,
            97,
            101,
            52,
            101,
            45,
            53,
            100,
            99,
            99,
            51,
            98,
            98,
            55,
            55,
            51,
            50,
            48,
            60,
            47,
            110,
            115,
            57,
            58,
            73,
            100,
            62,
            60,
            110,
            115,
            57,
            58,
            83,
            101,
            110,
            100,
            101,
            114,
            62,
            60,
            110,
            115,
            57,
            58,
            72,
            67,
            80,
            62,
            60,
            110,
            115,
            57,
            58,
            73,
            110,
            115,
            116,
            62,
            60,
            110,
            115,
            57,
            58,
            78,
            97,
            109,
            101,
            62,
            78,
            65,
            86,
            60,
            47,
            110,
            115,
            57,
            58,
            78,
            97,
            109,
            101,
            62,
            60,
            110,
            115,
            57,
            58,
            73,
            100,
            62,
            56,
            56,
            57,
            54,
            52,
            48,
            55,
            56,
            50,
            60,
            47,
            110,
            115,
            57,
            58,
            73,
            100,
            62,
            60,
            110,
            115,
            57,
            58,
            84,
            121,
            112,
            101,
            73,
            100,
            32,
            86,
            61,
            34,
            69,
            78,
            72,
            34,
            32,
            68,
            78,
            61,
            34,
            79,
            114,
            103,
            97,
            110,
            105,
            115,
            97,
            115,
            106,
            111,
            110,
            115,
            110,
            117,
            109,
            109,
            101,
            114,
            101,
            116,
            32,
            105,
            32,
            69,
            110,
            104,
            101,
            116,
            115,
            114,
            101,
            103,
            105,
            115,
            116,
            101,
            114,
            101,
            116,
            34,
            47,
            62,
            60,
            110,
            115,
            57,
            58,
            68,
            101,
            112,
            116,
            62,
            60,
            110,
            115,
            57,
            58,
            78,
            97,
            109,
            101,
            62,
            84,
            79,
            118,
            101,
            105,
            115,
            75,
            111,
            109,
            109,
            117,
            110,
            105,
            107,
            97,
            115,
            106,
            111,
            110,
            115,
            84,
            106,
            101,
            110,
            101,
            115,
            116,
            101,
            110,
            60,
            47,
            110,
            115,
            57,
            58,
            78,
            97,
            109,
            101,
            62,
            60,
            47,
            110,
            115,
            57,
            58,
            68,
            101,
            112,
            116,
            62,
            60,
            47,
            110,
            115,
            57,
            58,
            73,
            110,
            115,
            116,
            62,
            60,
            47,
            110,
            115,
            57,
            58,
            72,
            67,
            80,
            62,
            60,
            47,
            110,
            115,
            57,
            58,
            83,
            101,
            110,
            100,
            101,
            114,
            62,
            60,
            110,
            115,
            57,
            58,
            82,
            101,
            99,
            101,
            105,
            118,
            101,
            114,
            62,
            60,
            110,
            115,
            57,
            58,
            72,
            67,
            80,
            62,
            60,
            110,
            115,
            57,
            58,
            73,
            110,
            115,
            116,
            62,
            60,
            110,
            115,
            57,
            58,
            78,
            97,
            109,
            101,
            62,
            84,
            118,
            101,
            105,
            116,
            97,
            32,
            76,
            101,
            103,
            101,
            115,
            101,
            110,
            116,
            101,
            114,
            60,
            47,
            110,
            115,
            57,
            58,
            78,
            97,
            109,
            101,
            62,
            60,
            110,
            115,
            57,
            58,
            73,
            100,
            62,
            49,
            51,
            56,
            50,
            60,
            47,
            110,
            115,
            57,
            58,
            73,
            100,
            62,
            60,
            110,
            115,
            57,
            58,
            84,
            121,
            112,
            101,
            73,
            100,
            32,
            86,
            61,
            34,
            72,
            69,
            82,
            34,
            32,
            68,
            78,
            61,
            34,
            73,
            100,
            101,
            110,
            116,
            105,
            102,
            105,
            107,
            97,
            116,
            111,
            114,
            32,
            102,
            114,
            97,
            32,
            72,
            101,
            108,
            115,
            101,
            116,
            106,
            101,
            110,
            101,
            115,
            116,
            101,
            101,
            110,
            104,
            101,
            116,
            115,
            114,
            101,
            103,
            105,
            115,
            116,
            101,
            114,
            101,
            116,
            32,
            40,
            72,
            69,
            82,
            45,
            105,
            100,
            41,
            34,
            47,
            62,
            60,
            110,
            115,
            57,
            58,
            72,
            67,
            80,
            101,
            114,
            115,
            111,
            110,
            62,
            60,
            110,
            115,
            57,
            58,
            78,
            97,
            109,
            101,
            62,
            75,
            105,
            110,
            103,
            97,
            32,
            86,
            97,
            108,
            101,
            114,
            105,
            97,
            32,
            68,
            97,
            118,
            111,
            116,
            105,
            110,
            101,
            32,
            68,
            114,
            32,
            75,
            101,
            114,
            101,
            107,
            101,
            115,
            70,
            97,
            109,
            105,
            108,
            121,
            60,
            47,
            110,
            115,
            57,
            58,
            78,
            97,
            109,
            101,
            62,
            60,
            110,
            115,
            57,
            58,
            73,
            100,
            62,
            57,
            49,
            50,
            52,
            48,
            54,
            51,
            60,
            47,
            110,
            115,
            57,
            58,
            73,
            100,
            62,
            60,
            110,
            115,
            57,
            58,
            84,
            121,
            112,
            101,
            73,
            100,
            32,
            86,
            61,
            34,
            72,
            69,
            82,
            34,
            47,
            62,
            60,
            47,
            110,
            115,
            57,
            58,
            72,
            67,
            80,
            101,
            114,
            115,
            111,
            110,
            62,
            60,
            47,
            110,
            115,
            57,
            58,
            73,
            110,
            115,
            116,
            62,
            60,
            47,
            110,
            115,
            57,
            58,
            72,
            67,
            80,
            62,
            60,
            47,
            110,
            115,
            57,
            58,
            82,
            101,
            99,
            101,
            105,
            118,
            101,
            114,
            62,
            60,
            110,
            115,
            57,
            58,
            83,
            116,
            97,
            116,
            117,
            115,
            32,
            86,
            61,
            34,
            50,
            34,
            32,
            68,
            78,
            61,
            34,
            65,
            118,
            118,
            105,
            115,
            116,
            34,
            47,
            62,
            60,
            110,
            115,
            57,
            58,
            69,
            114,
            114,
            111,
            114,
            32,
            86,
            61,
            34,
            88,
            57,
            57,
            34,
            32,
            83,
            61,
            34,
            50,
            46,
            49,
            54,
            46,
            53,
            55,
            56,
            46,
            49,
            46,
            49,
            50,
            46,
            52,
            46,
            49,
            46,
            49,
            46,
            56,
            50,
            50,
            49,
            34,
            32,
            68,
            78,
            61,
            34,
            70,
            105,
            110,
            110,
            101,
            114,
            32,
            105,
            110,
            103,
            101,
            110,
            32,
            100,
            97,
            116,
            97,
            32,
            111,
            109,
            32,
            65,
            98,
            111,
            110,
            110,
            101,
            109,
            101,
            110,
            116,
            101,
            116,
            34,
            47,
            62,
            60,
            110,
            115,
            57,
            58,
            79,
            114,
            105,
            103,
            105,
            110,
            97,
            108,
            77,
            115,
            103,
            73,
            100,
            62,
            60,
            110,
            115,
            57,
            58,
            77,
            115,
            103,
            84,
            121,
            112,
            101,
            32,
            86,
            61,
            34,
            72,
            101,
            110,
            116,
            80,
            97,
            115,
            105,
            101,
            110,
            116,
            108,
            105,
            115,
            116,
            101,
            34,
            32,
            68,
            78,
            61,
            34,
            72,
            101,
            110,
            116,
            32,
            112,
            97,
            115,
            105,
            101,
            110,
            116,
            108,
            105,
            115,
            116,
            101,
            34,
            47,
            62,
            60,
            110,
            115,
            57,
            58,
            73,
            115,
            115,
            117,
            101,
            68,
            97,
            116,
            101,
            62,
            50,
            48,
            50,
            49,
            45,
            48,
            49,
            45,
            49,
            56,
            84,
            49,
            52,
            58,
            53,
            56,
            58,
            49,
            52,
            60,
            47,
            110,
            115,
            57,
            58,
            73,
            115,
            115,
            117,
            101,
            68,
            97,
            116,
            101,
            62,
            60,
            110,
            115,
            57,
            58,
            73,
            100,
            62,
            49,
            101,
            100,
            52,
            100,
            100,
            49,
            98,
            45,
            101,
            99,
            52,
            102,
            45,
            52,
            102,
            99,
            51,
            45,
            98,
            49,
            53,
            50,
            45,
            49,
            55,
            51,
            55,
            53,
            53,
            53,
            98,
            52,
            55,
            98,
            57,
            60,
            47,
            110,
            115,
            57,
            58,
            73,
            100,
            62,
            60,
            47,
            110,
            115,
            57,
            58,
            79,
            114,
            105,
            103,
            105,
            110,
            97,
            108,
            77,
            115,
            103,
            73,
            100,
            62,
            60,
            47,
            110,
            115,
            57,
            58,
            65,
            112,
            112,
            82,
            101,
            99,
            62
        )

        val string = String(payloadAsByteArray)
        println(string)
    }
}
